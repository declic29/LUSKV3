{% extends "simple/base.html" %}

{% block content %}
<!-- Votre contenu existant de la page d'accueil -->

<div id="news-container" class="container" style="margin-top: 30px; max-width: 800px;">
    <h2 style="text-align: center;">Actualités</h2>
    <div id="news-results" class="row"></div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Configuration simple sans variable d'environnement pour tester
    const apiKey = '2a28af6c4ebc58d5beba1fc150c105eb'; // Remplacez temporairement par votre clé
    
    fetchNews(apiKey);
});

function fetchNews(apiKey) {
    const url = `https://gnews.io/api/v4/top-headlines?token=${apiKey}&lang=fr&country=fr&max=4`;
    const container = document.getElementById('news-results');
    
    if (!container) return;
    
    container.innerHTML = '<div class="text-center">Chargement...</div>';
    
    fetch(url)
        .then(response => {
            if (!response.ok) throw new Error('Erreur réseau');
            return response.json();
        })
        .then(data => {
            if (data.articles?.length > 0) {
                container.innerHTML = data.articles.map(article => `
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="news-card">
                            <h3><a href="${article.url}" target="_blank" rel="noopener">${article.title}</a></h3>
                            ${article.image ? `<img src="${article.image}" alt="${article.title}" loading="lazy">` : ''}
                            <p>${article.description || ''}</p>
                        </div>
                    </div>
                `).join('');
            } else {
                container.innerHTML = '<p class="text-center">Aucune actualité disponible</p>';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            container.innerHTML = '<p class="text-center">Service temporairement indisponible</p>';
        });
}
</script>
{% endblock %}
