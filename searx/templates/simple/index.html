{% extends "simple/base.html" %}

{% block content %}
<!-- Votre contenu existant de la page d'accueil -->

<div id="news-container" class="container" style="margin-top: 30px; max-width: 800px;">
    <h2 style="text-align: center;">Actualités</h2>
    <div id="news-results" class="row"></div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const apiKey = '{{ env.GNEWS_API_KEY }}'; // Utilisez une variable d'environnement
    const url = `https://gnews.io/api/v4/top-headlines?token=${apiKey}&lang=fr&country=fr&max=4`;
    
    const container = document.getElementById('news-results');
    if (!container) return;
    
    container.innerHTML = '<div class="text-center">Chargement des actualités...</div>';
    
    fetch(url)
        .then(response => response.json())
        .then(data => {
            if (data.articles && data.articles.length > 0) {
                let html = '';
                data.articles.forEach(article => {
                    html += `
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="news-card">
                            <h3><a href="${article.url}" target="_blank">${article.title}</a></h3>
                            ${article.image ? `<img src="${article.image}" alt="${article.title}">` : ''}
                            <p>${article.description || ''}</p>
                        </div>
                    </div>
                    `;
                });
                container.innerHTML = html;
            } else {
                container.innerHTML = '<p class="text-center">Aucune actualité disponible</p>';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            container.innerHTML = '<p class="text-center">Impossible de charger les actualités</p>';
        });
});
</script>
{% endblock %}
